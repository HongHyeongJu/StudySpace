### K-MOOC 데이터베이스 보안 강의 청강
#### 7주차. 데이터베이스 시스템 보안

<br>
<br>

## [1. 사용자 인증 및 권한 부여]

<br>

#### 사용자 인증
* 특정 시스템에 접속을 시도하려는 사용자가 올바른 사용자인지 판단함(신분을 검증)
  * 패스워드 기반 인증 방식 = 지식 기반 인증
    * 장점 : 단순
    * 단점 : 유출이 쉽고 활용 위험 존재
* 사용자 인증 요소
  * 지식 기반 - 패스워드, 캡차 CAPTCHA
  * 소유 기반 - 토큰, 열쇠, 보안카드
  * 존재 기반 - 지문, 홍채, DNA
    * 장점: 도난 위험 없고, 복제 어려움  
    * 단점: 인식 정확도, 복제되면 재발행 불가능
  * 행위 기반 - 서명, 음성, 걸음걸이
* 소유기반 인증
  * 보안카드, OTP
* 다중 인증 요소 기반 인증 방식
  * 높은 보안이 요구되는 경우 여러가지 방법의 인증을 복합적으로 사용함

<br>

#### DBMS 사용자 인증
* 기본적으로 패스워드 기반 인증 사용(지식 기반)
* OS인증 기능도 제공
* 네트워크 인증도 추가로 지원 (ex- Kerberos - 리소스관련 토큰 확인)

<br>

#### 사용자 권한 부여 및 관리
* 시스템 권한 부여
  * 작업을 위한 권한을 DBA가 사용자에 부여
* 객체 권한 부여
  * 여러객체에 대해 객체 소유자가 사용권한 부여
* 사용자 관리
  * 권한 회수, 권한부여 진행상황 모니터링
  * 모니터링
    * Oracle : 데이터 사전 뷰
    * MySQL : 정보 스키마

<br>
<br>


## [2. 데이터베이스 접근제어 관리/ 3.취약점 분석]
* 뷰 : 하나 이상의 테이블에서 일부 컬럼들을 모아 만든 가상의 테이블(기존의 테이블, 뷰로 생성할 수 있음)
  * 필요한 정보만 얻을 수 있도록 구성하여서 물리적 테이블의 민감한 데이터가 보여지지 않도록 할 수 있음
* 뷰 기반 접근 통제
  * 데이터를 변경할 수 없도록 뷰를 구성하여 접근통제를 수행할 수 있음
* SQL문 기반 접근 통제
  * DCL을 이용하여 사용자에게 특정 권한만을 부여하여 작업을 제한함
  * GRANT문을 이용하여 일부 데이터에 대해 DML, DDL 사용 제약

 <br>


* 데이터 보안 : 외내부 여러 사용자로부터 데이터 베이스를 안전하게 보호하는 것(기밀성, 무결성, 가용성)
* 취약점과 위협의 관계
  * 취약점은 위협이 자산에 손실을 입히기 위해 이용하는 수단
  * 데이터베이스 관리자는 위협이 데이터베이스 또는 DBMS의 취약점을 이용하지 못하도록 취약점을 제거하여 위협 최소화 방안 모색
* 데이터베이스 취약점 **분석 설계**
  * 분석할 내/외부 접근 경로 선택 
  * DB조사시 취약점 식별하지 못하면 취약점을 제거할 수 없게됨. 매우 중요한 단계
  * 일반적으로 데이터베이스 취약점 분석 솔루션을 통해 데이터베이스 취약점 분석부터 점검까지 함께 수행함
* 데이터베이스 접근 경로에 따른 취약점 분석
  * 보안 솔루션을 우회한 공격
  * 내부자공격, 외부공격 툴을 이용한 접근 공격 시도
  * 애플리케이션, 내부인가자, 웹서버 -> 취약점을 사용하는 위협의 경로로 작용 가능
* 데이터베이스 취약점 **분석 구축**
  * 어떻게 취약점 점검을 수행할지 항목을 결정하는 단계
  * 외부 사용자 : 모의 해킹
  * 내부 사용자 : 내부 보안 감사
* 모의 해킹
  * 외부 사용자에 대한 침해 공격을 시뮬레이션하는 행위
  * 취약점 검출, 공격 가능한 경로 파악 가능
  * ex) 버퍼 오버플로 공격, DoS 공격
  * 주요 점검 항목 : TNS Attack, Dos, Password Attack, Confidurations
* 내부 보안 감사
  * 데이터베이스가 보안상 안전하게 운영되고 있는지 점검

 <br>

<br>


## [4. DBMS 취약점 점검/ 5. 데이터베이스 보안 개발]

### 취약점 점검

 <br>

#### MySQL 취약점 점검
* 클라우드 취약점 점검 가이드(한국인터넷진흥원 2020.12)
  * 클라우드를 통해 DBMS 서비스를 제공하는 서비스 공급자를 위한 보안 가이드라인 제시
* 취약점 점검 항목
  * 가. 계정 관리(불필요한 계정 제거, 취약한 패스워드 사용 제한, 타 사용자에 대한 권한부여 옵션 사용 제한, DB사용자 계정 정보 테이블 접근 권한)
  * 나. 보안 설정(root권한으로 서버 구동 제한, 환경설정 파일 접근 권한, 안전한 암호화 알고리즘 사용)
  * 다. 패치 및 로그관리(로그 활성화, 최신 패치 적용)
* 각 항목 중 중요한 고려점
  * 취약한 패스워드 사용 제한 : 패스워드가 계정명과 동일하거나 default 패스워스를 사용하는 경우, 사용자 계정의 패스워드가 null인 경우 -> 패스워드 설정 규칙 적용하기
  * root 권한으로 서버 권한 제한하기 : 기본적으로 root권한은 시스템 내에서 최고 상위 권한으로 소수의 관리자만이 제한적으로 사용되도록 하기 
    * 실생중인 프로레스를 통해 확인 / my.cnf파일에서 [mysqlid] 그룹의 'user' 지시자의 설정 값 확인하기
  * 최신 패치 적용하기
 <br>

#### Oracle 취약점 점검
* 취약점 점검 하목
  * 가. 계정 관리(기본계정 패스워드 권한 변경해서 사용, 불필요한 계정 제거나 잠금, 패스워드 사용기간 복잡도 정책, 관리자 권한을 필요한 계정및 그룹에만 허용, 패스워드 재사용 제약, DB 사용자 계정을 개별적으로 부여)
  * 나. 접근 관리(원겨에서 DB서버로 접속 제한, DBA외에 인가되지 않은 사용자 접근 제한, 리스너 패스워드를 설정해서 사용, 불필요한 데이터소스 드라이버 제거, 일정횟수 이상 로그인 실패시 잠금, DB계정의 umask 022이상 설정 사용)
  * (설정파일, 패스워드 파일 등 주요파일 접근 권한 적절하게 설정, 관리자 이외의 사용자의 오라클 리스너 접속을 통한 리스너 로그, trace파일 변경 제한)
  * 다. 옵션 관리(응용프로그램이나 DBA계정의 Role이 Public 설정되지 않도록 조정, OS_ROLE, REMOTE_OS_AUTHEBTICATION, REMOTE_OS_ORLES를 false로 설정, 패스워드 확인함수 설정, 안가되지 않은 object Owner제한)
  * 라. 패치 관리(최신보안패치와 밴더 권고사항 모두 적용, 감사기록은 정책에 적합하도록 설정, 보안에 강한 버전 사용)
  * 마. 로그 관리(Audit Table은 데이터베이스 관리자 계정에 접근하도록 제한)
* 각 항목 중 중요한 고려점
  * DBA권한을 꼭 필요한 계정 및 그룹에 허용
  * DBA 이외의 비인가 사용자 시스템 테이블에 접슨할 수 없도록 설정
  * OS_ROLE, REMOTE_OS_AUTHEBTICATION, REMOTE_OS_ORLES를 false로 설정



<br>
<br>


### 데이터베이스 보안 개발

 <br>

#### 보안
* DBA, 보안부서, 시스템 엔지니어 유기적으로 데이터 베이스 보안을 담당함
* 보안부서
  * 쉬운 초기 설정을 보완하는 보안 가이드 생성
  * 기본포트(3306) 변경, 패스워드 규칙, 로그 남기는 규칙 가이드 만들기
* DBA
  * 보안에 대한 설정을 데이터베이스에 적용함

 <br>

#### 데이터베이스 감사
* 주기별로 DB 접근 사용자에 대한 권한 점검
  * 서비스 마스터가 주기적으로 사용자 접근 권한을 점검함
* 주기적으로 로그 남기기
  * 로그는 침해사고 발생 시 공격자 분석에 도움 됨
* DBMS에서의 데이터암호화 현황
  * 개인정보보호 관련 법령에 따라 반드시 암호화를 해야하는 항목 확인하기
  * 사용자 패스워드는 단방향 Hash함수 사용
  * 기타 민감한 정보(전화번호, 주소) 내부적으로 대칭키를 사용하여서 암호화 및 복원(복호화)
* 데이터베이스 전체를 암호화 하는 것은 드문 경우
* DBMS를 안전하게 구축하는 방법
  * 다양한 보안 체크리스트(검색)
  * 로그 n개월 단위, 패스워트 암호화, 등
  * 기본 보안 가이드 준수 -> 대부분의 공격 침투 방지 가능함
* 오픈소스 특성상 취약점이 계속 발생함
  * 시스템 엔지니어, 개발자 협업을 통해 빠른 패치 적용하기
* 데이터베이스 시큐어 코딩을 위한 가이드
  * KISA에서 배포
  * 가이드만 지켜도 많은 공격 예방 가능
  * 외부의 직접적인 공격을 받을 수 있는 경우 서버 분리 필요함
  * DB서버를 외부에 노출시키지 않도록 구성하기









