## Spring Boot Maven 플러그인으로 Docker 이미지 빌드하기


<br>


### 스프링 부트 Maven 플러그인
* Maven에서 스프링 부트 지원을 제공함
* 실행할 수 있는 JAR 패키지를 생성하거나, 
* 스프링 부트 애플리케이션을 실행하거나
* 컨테이너 이미지를 생성하고자 한다면
* 스프링 부트 Maven 플러그인을 사용하여 명령줄에서 이 모든 것을 수행할 수 있음
* 장점
  * Dockerfile을 생성할 필요가 없음
  * Dockerfile을 효율적으로 만들려고 노력하지 않아도됨

<br>

#### 이 플러그인이 제공하는 다양한 명령어
* ```repackage```
  * JAR 또는 WAR를 생성할 수 있음
* ```mvn spring-boot:run```
  * 애플리케이션을 실행할 수 있음
* ```mvn spring-boot:start```
  * 논블로킹 방식, 통합 테스트를 할 수 있음
* ```mvn spring-boot:stop```
  * start 명령어로 시작한 애플리케이션을 중단할 수 있음
* ```mvn spring-boot:build-image``` 
  * 이 명령어로 인해서 앞서 생성해두었던 이 Dockerfile은 더 이상 필요하지 않음

<br>

* 프로젝트 우클릭 -> Run As ->  Maven Build를 차례대로 클릭
* ```spring-boot:build-image```를 붙여넣음
* Run을 클릭 (Docker가 백그라운드에서 실행하도록)
  * 전체 빌드 프로세스가 다시 실행되고, 테스트가 실행되고, JAR가 생성됨을 확인할 수 있음
  * 터미널에서 빌드 프로세스도 확인할 수 있고, 빌드 팩도 사용할 수 있음


<br>

### OCI 이미지
* 빌드 팩을 사용하여 오픈 컨테이너 이니셔티브 호환 이미지 즉, OCI 이미지를 빌드함
* OCI 이미지를 빌드한 후, OCI와 호환되는 모든 런타임에서 실행할 수 있음
* Docker는 OCI 이미지 형식과 호환되는 런타임
* 이에 따라 Docker 런타임을 사용하여 OCI 이미지도 실행할 수 있음


<br>

### spring-boot:build-image 명령어
* 이 spring-boot:build-image 명령어에 관해 주목해야 할 점
  * 매우 효율적인 이미지를 생성함
  * 앞서 생성했던 이미지보다 훨씬 더 작은 이미지를 생성할 수 있음
  * 첫 번째 빌드는 오래 걸리지만, 다음 빌드는 시간이 훨씬 더 단축됨
* 빌드 팩과 관련해서 문제 발생 시 첫번째로 확인할 것은 로컬에 해당 자바 버전의 설치 여부
* 이 빌드 프로세스의 중요한 점은 속도가 굉장히 빠르다는 것
  * 코드에 변경 사항이 있어도 빌드가 훨씬 더 빨라짐







